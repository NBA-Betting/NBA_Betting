FEATURE_TABLE_INFO = {
    "team_fivethirtyeight_games": {
        "primary_key": ["date", "team1", "team2"],
        "date_column": "date",
        "info_columns": ["date", "team1", "team2"],
        "feature_columns": [
            "elo1_pre",
            "elo2_pre",
            "elo_prob1",
            "elo_prob2",
            "carm_elo1_pre",
            "carm_elo2_pre",
            "carm_elo_prob1",
            "carm_elo_prob2",
            "raptor1_pre",
            "raptor2_pre",
            "raptor_prob1",
            "raptor_prob2",
        ],
    },
    "team_nbastats_general_traditional": {
        "primary_key": ["team_name", "to_date", "games"],
        "date_column": "to_date",
        "info_columns": ["team_name", "to_date", "games"],
        "feature_columns": ["gp", "w", "l", "w_pct", "min", "pts", "plus_minus"],
    },
    "team_nbastats_general_advanced": {
        "primary_key": ["team_name", "to_date", "games"],
        "date_column": "to_date",
        "info_columns": ["team_name", "to_date", "games"],
        "feature_columns": [
            "off_rating",
            "e_off_rating",
            "def_rating",
            "e_def_rating",
            "net_rating",
            "e_net_rating",
            "ast_pct",
            "ast_to",
            "ast_ratio",
            "oreb_pct",
            "dreb_pct",
            "reb_pct",
            "tm_tov_pct",
            "efg_pct",
            "ts_pct",
            "pace",
            "e_pace",
            "pace_per40",
            "poss",
            "pie",
        ],
    },
    "team_nbastats_general_fourfactors": {
        "primary_key": ["team_name", "to_date", "games"],
        "date_column": "to_date",
        "info_columns": ["team_name", "to_date", "games"],
        "feature_columns": [
            "efg_pct",
            "fta_rate",
            "tm_tov_pct",
            "oreb_pct",
            "opp_efg_pct",
            "opp_fta_rate",
            "opp_tov_pct",
            "opp_oreb_pct",
        ],
    },
    "team_nbastats_general_opponent": {
        "primary_key": ["team_name", "to_date", "games"],
        "date_column": "to_date",
        "info_columns": ["team_name", "to_date", "games"],
        "feature_columns": [
            "opp_fgm",
            "opp_fga",
            "opp_fg_pct",
            "opp_fg3m",
            "opp_fg3a",
            "opp_fg3_pct",
            "opp_ftm",
            "opp_fta",
            "opp_ft_pct",
            "opp_oreb",
            "opp_dreb",
            "opp_reb",
            "opp_ast",
            "opp_tov",
            "opp_stl",
            "opp_blk",
            "opp_blka",
            "opp_pf",
            "opp_pfd",
            "opp_pts",
            "plus_minus",
        ],
    },
}


TEAM_FULL_NAME_MAP = {
    "Washington Wizards": "WAS",
    "Washington Bullets": "WAS",
    "Brooklyn Nets": "BKN",
    "Chicago Bulls": "CHI",
    "Miami Heat": "MIA",
    "Cleveland Cavaliers": "CLE",
    "Philadelphia 76ers": "PHI",
    "New York Knicks": "NYK",
    "Charlotte Hornets": "CHA",
    "Boston Celtics": "BOS",
    "Toronto Raptors": "TOR",
    "Milwaukee Bucks": "MIL",
    "Atlanta Hawks": "ATL",
    "Indiana Pacers": "IND",
    "Detroit Pistons": "DET",
    "Orlando Magic": "ORL",
    "Golden State Warriors": "GSW",
    "Phoenix Suns": "PHX",
    "Dallas Mavericks": "DAL",
    "Denver Nuggets": "DEN",
    "Los Angeles Clippers": "LAC",
    "LA Clippers": "LAC",
    "Utah Jazz": "UTA",
    "Los Angeles Lakers": "LAL",
    "Memphis Grizzlies": "MEM",
    "Vancouver Grizzlies": "MEM",
    "Portland Trail Blazers": "POR",
    "Sacramento Kings": "SAC",
    "Oklahoma City Thunder": "OKC",
    "Minnesota Timberwolves": "MIN",
    "San Antonio Spurs": "SAS",
    "New Orleans Pelicans": "NOP",
    "Houston Rockets": "HOU",
    "Charlotte Bobcats": "CHA",
    "New Orleans Hornets": "NOP",
    "New Jersey Nets": "BKN",
    "Seattle SuperSonics": "OKC",
    "New Orleans/Oklahoma City Hornets": "NOP",
}

TEAM_SHORT_NAME_MAP = {
    "Nets": "BKN",
    "Celtics": "BOS",
    "Bucks": "MIL",
    "Hawks": "ATL",
    "Hornets": "CHA",
    "Bulls": "CHI",
    "Cavaliers": "CLE",
    "Mavericks": "DAL",
    "Nuggets": "DEN",
    "Pistons": "DET",
    "Warriors": "GSW",
    "Rockets": "HOU",
    "Pacers": "IND",
    "Clippers": "LAC",
    "Lakers": "LAL",
    "Grizzlies": "MEM",
    "Heat": "MIA",
    "Timberwolves": "MIN",
    "Pelicans": "NOP",
    "Knicks": "NYK",
    "Thunder": "OKC",
    "Magic": "ORL",
    "76ers": "PHI",
    "Suns": "PHX",
    "Trail Blazers": "POR",
    "Spurs": "SAS",
    "Kings": "SAC",
    "Raptors": "TOR",
    "Jazz": "UTA",
    "Wizards": "WAS",
}

VALID_TEAM_ABBREVIATIONS = [
    "ATL",
    "BKN",
    "BOS",
    "CHA",
    "CHI",
    "CLE",
    "DAL",
    "DEN",
    "DET",
    "GSW",
    "HOU",
    "IND",
    "LAC",
    "LAL",
    "MEM",
    "MIA",
    "MIL",
    "MIN",
    "NOP",
    "NYK",
    "OKC",
    "ORL",
    "PHI",
    "PHX",
    "POR",
    "SAC",
    "SAS",
    "TOR",
    "UTA",
    "WAS",
]

VALID_TEAM_ABBREVIATION_MAP = {team: team for team in VALID_TEAM_ABBREVIATIONS}


TEAM_ABBREVIATION_MAP = {
    "BK": "BKN",
    "BRK": "BKN",
    "CHO": "CHA",
    "GS": "GSW",
    "NOK": "NOP",
    "NO": "NOP",
    "NY": "NYK",
    "SEA": "OKC",
    "PHO": "PHX",
    "SA": "SAS",
    "NOJ": "UTA",
    "BUF": "LAC",
    "VAN": "MEM",
    "NJN": "BKN",
    "NOH": "NOP",
    "SAN": "SAS",
    "SDC": "LAC",
    "CHH": "CHA",
    "UTH": "UTA",
    "KCK": "SAC",
    "PHL": "PHI",
    "WSB": "WAS",
}


TEAM_MAP = dict(
    TEAM_FULL_NAME_MAP.items()
    | TEAM_SHORT_NAME_MAP.items()
    | TEAM_ABBREVIATION_MAP.items()
    | VALID_TEAM_ABBREVIATION_MAP.items()
)


def team_name_mapper(team_name):
    return TEAM_MAP.get(team_name, team_name)


NBA_IMPORTANT_DATES = {
    "1976-1977": {
        "reg_season_start_date": "1976-10-21",
        "reg_season_end_date": "1977-04-10",
        "postseason_start_date": "1977-04-12",
        "postseason_end_date": "1977-06-05",
    },
    "1977-1978": {
        "reg_season_start_date": "1977-10-18",
        "reg_season_end_date": "1978-04-09",
        "postseason_start_date": "1978-04-11",
        "postseason_end_date": "1978-06-07",
    },
    "1978-1979": {
        "reg_season_start_date": "1978-10-13",
        "reg_season_end_date": "1979-04-08",
        "postseason_start_date": "1979-04-10",
        "postseason_end_date": "1979-06-01",
    },
    "1979-1980": {
        "reg_season_start_date": "1979-10-12",
        "reg_season_end_date": "1980-04-06",
        "postseason_start_date": "1980-04-08",
        "postseason_end_date": "1980-05-16",
    },
    "1980-1981": {
        "reg_season_start_date": "1980-10-10",
        "reg_season_end_date": "1981-04-05",
        "postseason_start_date": "1981-04-07",
        "postseason_end_date": "1981-05-14",
    },
    "1981-1982": {
        "reg_season_start_date": "1981-10-30",
        "reg_season_end_date": "1982-04-18",
        "postseason_start_date": "1982-04-20",
        "postseason_end_date": "1982-06-08",
    },
    "1982-1983": {
        "reg_season_start_date": "1982-10-29",
        "reg_season_end_date": "1983-04-17",
        "postseason_start_date": "1983-04-19",
        "postseason_end_date": "1983-06-01",
    },
    "1983-1984": {
        "reg_season_start_date": "1983-10-28",
        "reg_season_end_date": "1984-04-15",
        "postseason_start_date": "1984-04-17",
        "postseason_end_date": "1984-06-12",
    },
    "1984-1985": {
        "reg_season_start_date": "1984-10-26",
        "reg_season_end_date": "1985-04-14",
        "postseason_start_date": "1985-04-16",
        "postseason_end_date": "1985-06-09",
    },
    "1985-1986": {
        "reg_season_start_date": "1985-10-25",
        "reg_season_end_date": "1986-04-13",
        "postseason_start_date": "1986-04-15",
        "postseason_end_date": "1986-06-08",
    },
    "1986-1987": {
        "reg_season_start_date": "1986-10-31",
        "reg_season_end_date": "1987-04-19",
        "postseason_start_date": "1987-04-21",
        "postseason_end_date": "1987-06-14",
    },
    "1987-1988": {
        "reg_season_start_date": "1987-11-06",
        "reg_season_end_date": "1988-04-24",
        "postseason_start_date": "1988-04-28",
        "postseason_end_date": "1988-06-21",
    },
    "1988-1989": {
        "reg_season_start_date": "1988-11-04",
        "reg_season_end_date": "1989-04-23",
        "postseason_start_date": "1989-04-27",
        "postseason_end_date": "1989-06-13",
    },
    "1989-1990": {
        "reg_season_start_date": "1989-11-03",
        "reg_season_end_date": "1990-04-22",
        "postseason_start_date": "1990-04-26",
        "postseason_end_date": "1990-06-14",
    },
    "1990-1991": {
        "reg_season_start_date": "1990-11-02",
        "reg_season_end_date": "1991-04-21",
        "postseason_start_date": "1991-04-25",
        "postseason_end_date": "1991-06-12",
    },
    "1991-1992": {
        "reg_season_start_date": "1991-11-01",
        "reg_season_end_date": "1992-04-19",
        "postseason_start_date": "1992-04-23",
        "postseason_end_date": "1992-06-14",
    },
    "1992-1993": {
        "reg_season_start_date": "1992-11-06",
        "reg_season_end_date": "1993-04-25",
        "postseason_start_date": "1993-04-29",
        "postseason_end_date": "1993-06-20",
    },
    "1993-1994": {
        "reg_season_start_date": "1993-11-05",
        "reg_season_end_date": "1994-04-24",
        "postseason_start_date": "1994-04-28",
        "postseason_end_date": "1994-06-22",
    },
    "1994-1995": {
        "reg_season_start_date": "1994-11-04",
        "reg_season_end_date": "1995-04-23",
        "postseason_start_date": "1995-04-27",
        "postseason_end_date": "1995-06-14",
    },
    "1995-1996": {
        "reg_season_start_date": "1995-11-03",
        "reg_season_end_date": "1996-04-21",
        "postseason_start_date": "1996-04-25",
        "postseason_end_date": "1996-06-16",
    },
    "1996-1997": {
        "reg_season_start_date": "1996-11-01",
        "reg_season_end_date": "1997-04-20",
        "postseason_start_date": "1997-04-24",
        "postseason_end_date": "1997-06-13",
    },
    "1997-1998": {
        "reg_season_start_date": "1997-10-31",
        "reg_season_end_date": "1998-04-19",
        "postseason_start_date": "1998-04-23",
        "postseason_end_date": "1998-06-14",
    },
    "1998-1999": {
        "reg_season_start_date": "1999-02-05",  # Lockout-shortened season
        "reg_season_end_date": "1999-05-05",
        "postseason_start_date": "1999-05-08",
        "postseason_end_date": "1999-06-25",
    },
    "1999-2000": {
        "reg_season_start_date": "1999-11-02",
        "reg_season_end_date": "2000-04-19",
        "postseason_start_date": "2000-04-22",
        "postseason_end_date": "2000-06-19",
    },
    "2000-2001": {
        "reg_season_start_date": "2000-10-31",
        "reg_season_end_date": "2001-04-18",
        "postseason_start_date": "2001-04-21",
        "postseason_end_date": "2001-06-15",
    },
    "2001-2002": {
        "reg_season_start_date": "2001-10-30",
        "reg_season_end_date": "2002-04-17",
        "postseason_start_date": "2002-04-20",
        "postseason_end_date": "2002-06-12",
    },
    "2002-2003": {
        "reg_season_start_date": "2002-10-29",
        "reg_season_end_date": "2003-04-16",
        "postseason_start_date": "2003-04-19",
        "postseason_end_date": "2003-06-15",
    },
    "2003-2004": {
        "reg_season_start_date": "2003-10-28",
        "reg_season_end_date": "2004-04-14",
        "postseason_start_date": "2004-04-17",
        "postseason_end_date": "2004-06-15",
    },
    "2004-2005": {
        "reg_season_start_date": "2004-11-02",
        "reg_season_end_date": "2005-04-20",
        "postseason_start_date": "2005-04-23",
        "postseason_end_date": "2005-06-23",
    },
    "2005-2006": {
        "reg_season_start_date": "2005-11-01",
        "reg_season_end_date": "2006-04-19",
        "postseason_start_date": "2006-04-22",
        "postseason_end_date": "2006-06-20",
    },
    "2006-2007": {
        "reg_season_start_date": "2006-10-31",
        "reg_season_end_date": "2007-04-18",
        "postseason_start_date": "2007-04-21",
        "postseason_end_date": "2007-06-14",
    },
    "2007-2008": {
        "reg_season_start_date": "2007-10-30",
        "reg_season_end_date": "2008-04-16",
        "postseason_start_date": "2008-04-19",
        "postseason_end_date": "2008-06-17",
    },
    "2008-2009": {
        "reg_season_start_date": "2008-10-28",
        "reg_season_end_date": "2009-04-15",
        "postseason_start_date": "2009-04-18",
        "postseason_end_date": "2009-06-14",
    },
    "2009-2010": {
        "reg_season_start_date": "2009-10-27",
        "reg_season_end_date": "2010-04-14",
        "postseason_start_date": "2010-04-17",
        "postseason_end_date": "2010-06-17",
    },
    "2010-2011": {
        "reg_season_start_date": "2010-10-26",
        "reg_season_end_date": "2011-04-13",
        "postseason_start_date": "2011-04-16",
        "postseason_end_date": "2011-06-12",
    },
    "2011-2012": {
        "reg_season_start_date": "2011-12-25",  # Lockout-shortened season
        "reg_season_end_date": "2012-04-26",
        "postseason_start_date": "2012-04-28",
        "postseason_end_date": "2012-06-21",
    },
    "2012-2013": {
        "reg_season_start_date": "2012-10-30",
        "reg_season_end_date": "2013-04-17",
        "postseason_start_date": "2013-04-20",
        "postseason_end_date": "2013-06-20",
    },
    "2013-2014": {
        "reg_season_start_date": "2013-10-29",
        "reg_season_end_date": "2014-04-16",
        "postseason_start_date": "2014-04-19",
        "postseason_end_date": "2014-06-15",
    },
    "2014-2015": {
        "reg_season_start_date": "2014-10-28",
        "reg_season_end_date": "2015-04-15",
        "postseason_start_date": "2015-04-18",
        "postseason_end_date": "2015-06-16",
    },
    "2015-2016": {
        "reg_season_start_date": "2015-10-27",
        "reg_season_end_date": "2016-04-13",
        "postseason_start_date": "2016-04-16",
        "postseason_end_date": "2016-06-19",
    },
    "2016-2017": {
        "reg_season_start_date": "2016-10-25",
        "reg_season_end_date": "2017-04-12",
        "postseason_start_date": "2017-04-15",
        "postseason_end_date": "2017-06-12",
    },
    "2017-2018": {
        "reg_season_start_date": "2017-10-17",
        "reg_season_end_date": "2018-04-11",
        "postseason_start_date": "2018-04-14",
        "postseason_end_date": "2018-06-08",
    },
    "2018-2019": {
        "reg_season_start_date": "2018-10-16",
        "reg_season_end_date": "2019-04-10",
        "postseason_start_date": "2019-04-13",
        "postseason_end_date": "2019-06-13",
    },
    "2019-2020": {
        "reg_season_start_date": "2019-10-22",
        "reg_season_end_date": "2020-03-11",  # Season suspended due to COVID-19
        "postseason_start_date": "2020-08-17",  # Season resumed in the NBA Bubble
        "postseason_end_date": "2020-10-11",
    },
    "2020-2021": {
        "reg_season_start_date": "2020-12-22",
        "reg_season_end_date": "2021-05-16",
        "postseason_start_date": "2021-05-18",
        "postseason_end_date": "2021-07-20",
    },
    "2021-2022": {
        "reg_season_start_date": "2021-10-19",
        "reg_season_end_date": "2022-04-10",
        "postseason_start_date": "2022-04-12",
        "postseason_end_date": "2022-06-16",
    },
    "2022-2023": {
        "reg_season_start_date": "2022-10-18",
        "reg_season_end_date": "2023-04-09",
        "postseason_start_date": "2023-04-11",
        "postseason_end_date": "2023-06-12",
    },
    "2023-2024": {  # Estimated
        "reg_season_start_date": "2023-10-24",
        "reg_season_end_date": "2024-04-14",
        "postseason_start_date": "2024-04-16",
        "postseason_end_date": "2024-06-16",
    },
}
